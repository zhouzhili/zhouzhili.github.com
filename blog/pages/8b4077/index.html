<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 GLSL 绘图尝试：绘制正弦曲线 | Zhili&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/blog/img/favicon.ico">
    <meta name="description" content="web前端技术博客,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,React,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/blog/assets/css/0.styles.8f0008f7.css" as="style"><link rel="preload" href="/blog/assets/js/app.43666ae9.js" as="script"><link rel="preload" href="/blog/assets/js/3.54ddaff6.js" as="script"><link rel="preload" href="/blog/assets/js/4.189e77f3.js" as="script"><link rel="preload" href="/blog/assets/js/9.59a20a3c.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.8a2aaa50.js"><link rel="prefetch" href="/blog/assets/js/11.0f4130e3.js"><link rel="prefetch" href="/blog/assets/js/12.c605f846.js"><link rel="prefetch" href="/blog/assets/js/13.93a7e18d.js"><link rel="prefetch" href="/blog/assets/js/14.cf4b870a.js"><link rel="prefetch" href="/blog/assets/js/15.4acd200d.js"><link rel="prefetch" href="/blog/assets/js/16.4d859c0e.js"><link rel="prefetch" href="/blog/assets/js/17.257338e9.js"><link rel="prefetch" href="/blog/assets/js/18.a992ae26.js"><link rel="prefetch" href="/blog/assets/js/19.4670d65e.js"><link rel="prefetch" href="/blog/assets/js/20.2cccd8ed.js"><link rel="prefetch" href="/blog/assets/js/21.93d78d47.js"><link rel="prefetch" href="/blog/assets/js/22.7510f10a.js"><link rel="prefetch" href="/blog/assets/js/23.2e2ef396.js"><link rel="prefetch" href="/blog/assets/js/24.729e703d.js"><link rel="prefetch" href="/blog/assets/js/25.a3ade110.js"><link rel="prefetch" href="/blog/assets/js/26.d7f71263.js"><link rel="prefetch" href="/blog/assets/js/27.8bac9fbb.js"><link rel="prefetch" href="/blog/assets/js/28.a260e038.js"><link rel="prefetch" href="/blog/assets/js/29.7b752b64.js"><link rel="prefetch" href="/blog/assets/js/30.4009e83e.js"><link rel="prefetch" href="/blog/assets/js/31.f7d78a0c.js"><link rel="prefetch" href="/blog/assets/js/32.716ca128.js"><link rel="prefetch" href="/blog/assets/js/33.34bfcf15.js"><link rel="prefetch" href="/blog/assets/js/34.d8d785b2.js"><link rel="prefetch" href="/blog/assets/js/35.dc053720.js"><link rel="prefetch" href="/blog/assets/js/36.70a2f0bf.js"><link rel="prefetch" href="/blog/assets/js/5.7b2e465a.js"><link rel="prefetch" href="/blog/assets/js/6.d43e9012.js"><link rel="prefetch" href="/blog/assets/js/7.66afde9c.js"><link rel="prefetch" href="/blog/assets/js/8.d62d0ba6.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.b4682b6b.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.8f0008f7.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/logo.png" alt="Zhili's blog" class="logo"> <span class="site-name can-hide">Zhili's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div> <a href="https://github.com/zhouzhili/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/zhouzhili/cdn@1.0/img/avatar.jpg"> <div class="blogger-info"><h3>Zhili</h3> <span>转型中的前端老兵</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div> <a href="https://github.com/zhouzhili/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/blog/pages/a75779/" class="sidebar-link">webpack 区分环境使用CDN以及HtmlWebpackPlugin插件的编写</a></li><li><a href="/blog/pages/4d2a3f/" class="sidebar-link">使用 Mpvue 开发小程序总结</a></li><li><a href="/blog/pages/176915/" class="sidebar-link">前端知识汇总-持续更新</a></li><li><a href="/blog/pages/1b4d31/" class="sidebar-link">webGL知识汇总-持续更新</a></li><li><a href="/blog/pages/274136/" class="sidebar-link">React思想要点</a></li><li><a href="/blog/pages/23cb65/" class="sidebar-link">Mapbox 入门初试</a></li><li><a href="/blog/pages/bfde4d/" class="sidebar-link">构建自己的 GLSL 绘图器 - 2d 版</a></li><li><a href="/blog/pages/b46e51/" class="sidebar-link">webGL二维有向距离场(SDF)及布尔运算</a></li><li><a href="/blog/pages/91ebd0/" class="sidebar-link">webGL入门：绘制一个三角形</a></li><li><a href="/blog/pages/8b4077/" aria-current="page" class="active sidebar-link">使用 GLSL 绘图尝试：绘制正弦曲线</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/pages/82b434/" class="sidebar-link">简单解析虚拟 DOM</a></li><li><a href="/blog/pages/7d5b80/" class="sidebar-link">自己动手开发一个 markdown 转微信文章工具</a></li><li><a href="/blog/pages/dbe7b4/" class="sidebar-link">Vue组件扩展及权限管理的实现技巧</a></li><li><a href="/blog/pages/90b5f1/" class="sidebar-link">使用 CSS 绘制三角形</a></li><li><a href="/blog/pages/8b6cb8/" class="sidebar-link">Nginx 前端配置和使用</a></li><li><a href="/blog/pages/408c16/" class="sidebar-link">webpack按需加载配置和babel编译</a></li><li><a href="/blog/pages/2b309c/" class="sidebar-link">面试总结39题</a></li><li><a href="/blog/pages/d33585/" class="sidebar-link">使用node反向代理接口改造旧项目</a></li><li><a href="/blog/pages/21be49/" class="sidebar-link">可视化表单搭建系统的开发与思考</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-d5e9d2e6><div class="articleInfo" data-v-d5e9d2e6><ul class="breadcrumbs" data-v-d5e9d2e6><li data-v-d5e9d2e6><a href="/blog/" title="首页" class="iconfont icon-home router-link-active" data-v-d5e9d2e6></a></li> <li data-v-d5e9d2e6><a href="/blog/categories/?category=%E5%89%8D%E7%AB%AF" title="分类" data-v-d5e9d2e6>前端</a></li></ul> <div class="info" data-v-d5e9d2e6><div title="作者" class="author iconfont icon-touxiang" data-v-d5e9d2e6><a href="https://github.com/zhouzhili" target="_blank" title="作者" class="beLink" data-v-d5e9d2e6>zhili</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>2019-08-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">使用 GLSL 绘图尝试：绘制正弦曲线<!----></h1>  <div class="theme-vdoing-content content__default"><p>使用片元着色器绘制正弦曲线</p> <p>看了一部分 <a href="https://thebookofshaders.com/?lan=ch" target="_blank" rel="noopener noreferrer">《The Book of Shaders》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>之后大受启发，之前画三角形，画矩形以及画其他的图形都是在 JS 计算好各个点的位置，然后通过 buffer 传递到顶点着色器中，然后绘制出图形。这些计算点位的工作主要集中在 CPU 端进行，这种绘制方式大大浪费了 GPU 并行计算的能力，其实我们只在片元着色器也能绘制出这些图形，并且效率更高。</p> <p>在片元着色器中绘图，我们将使用一个重要的内置变量<strong>vec4 gl_FragCoord</strong>，在官方文档中这样解释：</p> <blockquote><p>Available only in the fragment language, gl_FragCoord is an input variable that contains the window relative coordinate (x, y, z, 1/w) values for the fragment. If multi-sampling, this value can be for any location within the pixel, or one of the fragment samples. This value is the result of fixed functionality that interpolates primitives after vertex processing to generate fragments. The z component is the depth value that would be used for the fragment's depth if no shader contained any writes to gl_FragDepth</p></blockquote> <p>gl_FragCoord 仅在片段着色器中可用，是一个输入变量，包含片段的窗口相对坐标（x，y，z，1 / w）值。这句话的意思是它的坐标就是当前片段的窗口相对坐标，回想起 webGL 的绘制方式：确定了定点之后，会调用片段着色器进行逐像素渲染。这时，每一个像素的坐标便是 gl_FragCoord 的 xyz 值。它的值的范围为 0 到渲染区域的宽高。<strong>它的坐标原点在左下角，x 向右递增，y 向上递增。</strong></p> <h3 id="绘制准备工作"><a href="#绘制准备工作" class="header-anchor">#</a> 绘制准备工作</h3> <p>首先，我们要使用 gl_FragCoord，需要先创建一个简单的 webGL 程序，我们绘制 2 个三角形组成一个矩形，在绘制三角形的时候 webGL 会调用片元着色器对三角形进行光栅化，在光栅化的过程中调用 fragment shader 进行对每个像素进行光栅化，在对每个像素进行处理的时候，当前被处理像素的坐标我们通过 gl_FragCoord 就可以得到。</p> <p>绘制三角形步骤略。</p> <p>webgl 坐标及颜色范围都在[-1,1]中间，而 gl_FragCoord 的范围是[0,width],[0,height],因此在使用中我们通常需要(也可以不做处理)归一化处理。
我们需要在 fragment 中获取 gl.canvas 的高宽，因此我们需要一个变量</p> <div class="language-glsl line-numbers-mode"><pre class="language-glsl"><code><span class="token keyword">uniform</span> <span class="token keyword">vec2</span> uResolution<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在 JS 程序中将 canvas 的高宽传给它，</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> uResolution <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token string">'uResolution'</span><span class="token punctuation">)</span>
gl<span class="token punctuation">.</span><span class="token function">uniform2f</span><span class="token punctuation">(</span>uResolution<span class="token punctuation">,</span> gl<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> gl<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后 vec2 st=gl_FragCoord.xy/uResolution;得到的就是归一化坐标值。</p> <h3 id="绘制正弦曲线"><a href="#绘制正弦曲线" class="header-anchor">#</a> 绘制正弦曲线</h3> <p>现在，我们可以尝试绘制一条正弦曲线 y=sin(x),但是我们已知的只有画布各个点的坐标值，我们可以将在正弦曲线上的点颜色设置为绿色，将正弦曲线外的点颜色设置为黑色，这样就能将曲线绘制出来；并且我们坐标的递增为一个像素值，y 值不可能完全与 sin(x)相等，我们需要设置一个范围，比如正负 0.01，只要 y 值落在这个范围内，我们就认为 y 的值为 sin(x),这样能够生成更为平滑的曲线，避免锯齿。</p> <p>首先我们写一个 plot 函数，该函数接收 2 个值，一个真实坐标值，一个目标值，如果真实值在目标值误差范围内则返回 1.0，否则范围 0.0</p> <div class="language-glsl line-numbers-mode"><pre class="language-glsl"><code><span class="token keyword">float</span> <span class="token function">plot</span><span class="token punctuation">(</span><span class="token keyword">float</span> sy<span class="token punctuation">,</span><span class="token keyword">float</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// float p=smoothstep(sy+.01,sy,y)-smoothstep(sy,sy-.01,y);</span>
  <span class="token comment">// return sign(p);</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>y<span class="token operator">-</span><span class="token number">.01</span><span class="token operator">&lt;</span>sy <span class="token operator">&amp;&amp;</span> sy<span class="token operator">&lt;</span>y<span class="token operator">+</span><span class="token number">.01</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1.</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0.</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>由于归一化之后 gl_FragCoord 坐标范围为[0,1]，为了绘制正弦曲线，我们将 x 轴范围映射到[0,2π]，y 轴范围映射到[-1,1]。main 函数如下所示：</p> <div class="language-glsl line-numbers-mode"><pre class="language-glsl"><code><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// gl_FragCoord是着色器当前位置的坐标值，xy范围为canvas的[0,width],[0,height]</span>
  <span class="token comment">// 下面st将gl_FragCoord转为webgl坐标[0,1]</span>
  <span class="token keyword">vec2</span> st<span class="token operator">=</span>gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>uResolution<span class="token punctuation">;</span>
  <span class="token keyword">float</span> PI<span class="token operator">=</span><span class="token number">3.1415926</span><span class="token punctuation">;</span>

  <span class="token comment">// x范围转到[0,2PI]</span>
  <span class="token keyword">float</span> tx<span class="token operator">=</span>st<span class="token punctuation">.</span>x<span class="token operator">*</span><span class="token number">2.</span><span class="token operator">*</span>PI<span class="token punctuation">;</span>
  <span class="token comment">// x范围转到[-1,1]</span>
  <span class="token keyword">float</span> ty<span class="token operator">=</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span>y<span class="token operator">*</span><span class="token number">2.</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">;</span>

  <span class="token comment">// y = sin(x) 曲线</span>
  <span class="token keyword">float</span> pct<span class="token operator">=</span><span class="token function">plot</span><span class="token punctuation">(</span>ty<span class="token punctuation">,</span><span class="token function">sin</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">vec3</span> color<span class="token operator">=</span>pct<span class="token operator">*</span><span class="token keyword">vec3</span><span class="token punctuation">(</span><span class="token number">0.</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token punctuation">,</span><span class="token number">.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl_FragColor<span class="token operator">=</span><span class="token keyword">vec4</span><span class="token punctuation">(</span>color<span class="token punctuation">,</span><span class="token number">1.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>如果点在 sin(tx)上，pct 为 1.0，乘以 vec3(0.,1.,.0)为其本身，否则，跑 pct 为 0.0,color 值为 vec3(0.0,0.0,0.0);
这样点在正弦曲线上颜色将为绿色，而曲线之外的部分颜色为黑色。</p> <p>接着，我们可以添加 x 轴与 y 轴辅助线，x 轴方程为 y=0,y 轴我们绘制为 x=PI，接着修改我们的 main 函数：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// y=0 直线 ，即X轴</span>
  float xPct<span class="token operator">=</span><span class="token function">plot</span><span class="token punctuation">(</span>ty<span class="token punctuation">,</span><span class="token number">0.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  vec3 xAxisColor<span class="token operator">=</span>xPct<span class="token operator">*</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token punctuation">,</span><span class="token number">0.</span><span class="token punctuation">,</span><span class="token number">0.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// x=PI 直线，即 Y轴</span>
  float yPct<span class="token operator">=</span><span class="token function">plot</span><span class="token punctuation">(</span>tx<span class="token punctuation">,</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  vec3 yAxisColor<span class="token operator">=</span>yPct<span class="token operator">*</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">0.</span><span class="token punctuation">,</span><span class="token number">0.</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 颜色相加即的得到要绘制的图形</span>
  color<span class="token operator">+=</span>xAxisColor<span class="token operator">+</span>yAxisColor<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>最后，显示的颜色最终值为三个绘图函数颜色值的和，如果在 y=sin(x)上，颜色为绿色；如果在 y=0 上，颜色为红色，如果在 x=π 上，颜色为蓝色。
最终我们的成果如下图所示：</p> <p><img src="https://raw.githubusercontent.com/zhouzhili/blog/master/issues/images/drawLine.png" alt="result"></p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>通过这个示例，我们可以绘制出更多的图形，根据各种造型函数，将函数区域与非函数区域绘制为 2 种不同的颜色我们便可以绘制出各种形状；另外，我们可以将多个绘图函数组合起来，绘制出更加多样的效果。而且这些直接在 GPU 中计算，性能将比通过 CPU 传递数据绘制更快。</p> <p>学习资源：</p> <p><a href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-fundamentals.html" target="_blank" rel="noopener noreferrer">webGL 基础知识<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://thebookofshaders.com/?lan=ch" target="_blank" rel="noopener noreferrer">着色器之书<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.shadertoy.com/" target="_blank" rel="noopener noreferrer">着色器资源网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm" target="_blank" rel="noopener noreferrer">距离场着色器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/zhouzhili/blog/edit/master/docs/01.前端/11.GLSL绘图初试.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/blog/tags/?tag=GLSL" title="标签">#GLSL</a><a href="/blog/tags/?tag=webGL" title="标签">#webGL</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/03/14, 06:54:51</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/blog/pages/91ebd0/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">webGL入门：绘制一个三角形</div></a> <a href="/blog/pages/82b434/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">简单解析虚拟 DOM</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/pages/91ebd0/" class="prev">webGL入门：绘制一个三角形</a></span> <span class="next"><a href="/blog/pages/82b434/">简单解析虚拟 DOM</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/blog/pages/0a6506/"><div>
            程序员副业尝试与总结
            <!----></div></a> <span class="date">03-17</span></dt></dl><dl><dd>02</dd> <dt><a href="/blog/pages/21be49/"><div>
            可视化表单搭建系统的开发与思考
            <!----></div></a> <span class="date">03-09</span></dt></dl><dl><dd>03</dd> <dt><a href="/blog/pages/d33585/"><div>
            使用node反向代理接口改造旧项目
            <!----></div></a> <span class="date">11-17</span></dt></dl> <dl><dd></dd> <dt><a href="/blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:zhou_zhili@foxmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/zhouzhili" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>zhili | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/blog/assets/js/app.43666ae9.js" defer></script><script src="/blog/assets/js/3.54ddaff6.js" defer></script><script src="/blog/assets/js/4.189e77f3.js" defer></script><script src="/blog/assets/js/9.59a20a3c.js" defer></script>
  </body>
</html>
