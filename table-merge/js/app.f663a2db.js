(function(t){function e(e){for(var o,r,s=e[0],l=e[1],i=e[2],f=0,h=[];f<s.length;f++)r=s[f],Object.prototype.hasOwnProperty.call(c,r)&&c[r]&&h.push(c[r][0]),c[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(h.length)h.shift()();return a.push.apply(a,i||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,s=1;s<n.length;s++){var l=n[s];0!==c[l]&&(o=!1)}o&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var o={},c={app:0},a=[];function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var i=0;i<s.length;i++)e(s[i]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-view")},a=[],r=n("2877"),s={},l=Object(r["a"])(s,c,a,!1,null,null,null),i=l.exports,u=n("8c4f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"test-page",on:{click:t.onCloseMenu}},[n("table",{ref:"table",attrs:{border:"1"},on:{contextmenu:function(e){return e.preventDefault(),t.openMenu(e)}}},t._l(t.tableRow,(function(e){return n("tr",{key:"r"+e},[t._l(t.tableCol,(function(o){return[t.isHide(e,o)?t._e():n("td",{key:e+o,class:t.isSelect(e,o)?"sel":"",attrs:{rowspan:t.getCellSpan("rowspan",e,o),colspan:t.getCellSpan("colspan",e,o)},on:{mousedown:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"left",37,n.key,["Left","ArrowLeft"])||"button"in n&&0!==n.button?null:t.onMouseLeftDown(e,o)},mouseover:function(n){return t.onMouseOver(e,o)},mouseup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:t.onMouseUp(e)}}},[t._v(" "+t._s(e+"-"+o)+" ")])]}))],2)})),0),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.showContextMenu,expression:"showContextMenu"}],staticClass:"contextmenu",style:t.pos},[n("li",{class:{disabled:!t.canInsert},on:{click:function(e){return e.stopPropagation(),t.handleInsert("top")}}},[t._v(" 上侧插入行 ")]),n("li",{class:{disabled:!t.canInsert},on:{click:function(e){return e.stopPropagation(),t.handleInsert("bottom")}}},[t._v(" 下侧插入行 ")]),n("li",{class:{disabled:!t.canInsert},on:{click:function(e){return e.stopPropagation(),t.handleInsert("left")}}},[t._v(" 左侧插入列 ")]),n("li",{class:{disabled:!t.canInsert},on:{click:function(e){return e.stopPropagation(),t.handleInsert("right")}}},[t._v(" 右侧插入列 ")]),n("hr"),n("li",{on:{click:function(e){return e.stopPropagation(),t.handleMergeCell(e)}}},[t._v(" 合并单元格 ")]),n("li",{class:{disabled:!t.isCanSplit()},on:{click:function(e){return e.stopPropagation(),t.handleSplitCell(e)}}},[t._v(" 拆分单元格 ")]),n("hr"),n("li",{class:{disabled:!t.canDeleteRow},on:{click:function(e){return e.stopPropagation(),t.handleDelRow(e)}}},[t._v(" 删除行 ")]),n("li",{class:{disabled:!t.canDeleteCol},on:{click:function(e){return e.stopPropagation(),t.handleDelCol(e)}}},[t._v(" 删除列 ")]),n("hr"),n("li",{on:{click:function(e){return e.stopPropagation(),t.clearSelect(e)}}},[t._v("清除选择")])])])},h=[],p=(n("99af"),n("4160"),n("c975"),n("d81d"),n("a434"),n("a9e3"),n("b64b"),n("ac1f"),n("1276"),n("159b"),n("3835")),d=n("5530"),b=n("2909"),v={name:"TableLayout",props:{tableMaxCol:{type:Number,default:10},tableMaxRow:{type:Number,default:15}},data:function(){var t=function(t){for(var e=[],n=0;n<t;n++)e.push(n);return e};return{showContextMenu:!1,pos:{left:0,top:0},tableRow:t(this.tableMaxRow),tableCol:t(this.tableMaxCol),canInsert:!0,canDeleteRow:!0,canDeleteCol:!0,conf:{},mouseState:"up",selectRect:{start:[],end:[],firstPoint:[]}}},mounted:function(){document.addEventListener("click",this.documentClick)},beforeDestroy:function(){document.removeEventListener("click",this.documentClick)},methods:{documentClick:function(){this.showContextMenu=!1},onMouseLeftDown:function(t,e){this.mouseState="down",this.selectRect={start:[t,e],end:[t,e],firstPoint:[t,e]}},onMouseOver:function(t,e){if("down"===this.mouseState){for(var n=Object(b["a"])(this.selectRect.firstPoint),o=n[0],c=n[1],a=[o,t].sort((function(t,e){return t-e})),r=[c,e].sort((function(t,e){return t-e})),s=[],l=[],i=a[0];i<a[1]+1;i++)for(var u=r[0];u<r[1]+1;u++){var f="".concat(i,"-").concat(u);if(this.conf[f]){var h=this.conf[f],p=h.rowspan,v=h.colspan;s.push(i,i+p-1),l.push(u,u+v-1)}}a=a.concat(s),r=r.concat(l),a.sort((function(t,e){return t-e})),r.sort((function(t,e){return t-e}));var w=[a[0],r[0]],C=[a[a.length-1],r[r.length-1]];this.selectRect=Object(d["a"])(Object(d["a"])({},this.selectRect),{},{start:[].concat(w),end:[].concat(C)})}},onMouseUp:function(){this.mouseState="up"},isSelect:function(t,e){var n=this.selectRect,o=n.start,c=n.end;return o[0]<=t&&t<=c[0]&&o[1]<=e&&e<=c[1]},isHide:function(t,e){if(this.conf["".concat(t,"-").concat(e)])return!1;for(var n=Object.keys(this.conf),o=!1,c=0;c<n.length;c++){var a=n[c],r=this.conf[a],s=r.colspan,l=r.rowspan,i=a.split("-").map((function(t){return Number(t)})),u=i[0],f=i[0]+l-1,h=i[1],p=i[1]+s-1;if(u<=t&&t<=f&&h<=e&&e<=p){o=!0;break}}return o},getCellSpan:function(t,e,n){var o=this.conf["".concat(e,"-").concat(n)];return o&&o[t]||1},handleTableCellClick:function(t,e){var n="".concat(t,"-").concat(e),o=this.selectCellId.indexOf(n);-1===o?this.selectCellId.push(n):this.selectCellId.splice(o,1)},isCanInsert:function(){var t=this.selectRect,e=t.start,n=t.end;return e[0]===n[0]&&e[1]===n[1]},isCanDelete:function(){var t=!0,e=!0,n=this.selectRect,o=n.start,c=n.end;return o[0]!==c[0]&&(t=!1),o[1]!==c[1]&&(e=!1),{canDeleteRow:t,canDeleteCol:e}},isCanSplit:function(){var t=this.selectRect.start,e=this.conf["".concat(t[0],"-").concat(t[1])];return this.isCanInsert()&&e},clearSelect:function(){this.selectRect={start:[],end:[],firstPoint:[]},this.showContextMenu=!1},handleSplitCell:function(){var t=this.selectRect.start,e="".concat(t[0],"-").concat(t[1]);this.$delete(this.conf,e),this.clearSelect()},handleConfEach:function(t){var e=this;Object.keys(this.conf).forEach((function(n){var o=n.split("-").map((function(t){return Number(t)}));t(n,Object(d["a"])({},e.conf[n]),o)}))},dealMergeCellInSelect:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.selectRect,o=n.start,c=n.end,a=Object.keys(this.conf),r=0;r<a.length;r++){var s=a[r],l=s.split("-").map((function(t){return Number(t)})),i=Object(p["a"])(l,2),u=i[0],f=i[1];if(o[0]<=u&&u<=c[0]&&o[1]<=f&&f<=c[1]&&(t(s),e))break}},handleMergeCell:function(){var t=this,e=this.selectRect,n=e.start,o=e.end,c=o[0]-n[0]+1,a=o[1]-n[1]+1;if(c>1||a>1){this.dealMergeCellInSelect((function(e){t.$delete(t.conf,e)}));var r="".concat(n[0],"-").concat(n[1]);this.$set(this.conf,r,{colspan:a,rowspan:c}),this.clearSelect()}},handleInsert:function(t){var e=this.selectRect.start,n={};this.handleConfEach((function(o,c,a){var r=Object(p["a"])(a,2),s=r[0],l=r[1];"top"===t||"bottom"===t?(s>e[0]||"top"===t&&s===e[0])&&(s+=1):"left"!==t&&"right"!==t||(l>e[1]||"left"===t&&l===e[1])&&(l+=1),n["".concat(s,"-").concat(l)]=c})),"top"===t||"bottom"===t?this.tableRow.push(this.tableRow.length):this.tableCol.push(this.tableCol.length),this.conf=n,this.clearSelect()},handleDelRow:function(){var t=this.selectRect.start[0];this.tableRow.pop();var e={};this.handleConfEach((function(n,o,c){var a=Object(d["a"])({},o),r=Object(p["a"])(c,2),s=r[0],l=r[1],i=s+a.rowspan;s<=t&&t<=i&&(a.rowspan=a.rowspan>1?a.rowspan-1:1),0!==s&&(s-=1),1===a.rowspan&&1===a.colspan||(e["".concat(s,"-").concat(l)]=a)})),this.conf=e,this.clearSelect()},handleDelCol:function(){var t=this.selectRect.start[1];this.tableCol.pop();var e={};this.handleConfEach((function(n,o,c){var a=Object(d["a"])({},o),r=Object(p["a"])(c,2),s=r[0],l=r[1],i=l+a.colspan;l<=t&&t<=i&&(a.colspan=a.colspan>1?a.colspan-1:1),0!==l&&(l-=1),1===a.rowspan&&1===a.colspan||(e["".concat(s,"-").concat(l)]=a)})),this.conf=e,this.clearSelect()},openMenu:function(t){if(this.selectRect.start.length>0){var e=t.clientX,n=t.clientY;this.pos={left:"".concat(e+10,"px"),top:"".concat(n+5,"px")},this.canInsert=this.isCanInsert();var o=this.isCanDelete(),c=o.canDeleteRow,a=o.canDeleteCol;this.canDeleteRow=c,this.canDeleteCol=a,this.showContextMenu=!0}},onCloseMenu:function(){this.showContextMenu&&(this.showContextMenu=!1)}}},w=v,C=(n("de16"),Object(r["a"])(w,f,h,!1,null,null,null)),m=C.exports;o["a"].use(u["a"]);var g=[{path:"/",name:"Home",component:m}],y=new u["a"]({routes:g}),k=y,O=n("2f62");o["a"].use(O["a"]);var R=new O["a"].Store({state:{},mutations:{},actions:{},modules:{}});n("f5df1");o["a"].config.productionTip=!1,new o["a"]({router:k,store:R,render:function(t){return t(i)}}).$mount("#app")},"8d91":function(t,e,n){},de16:function(t,e,n){"use strict";n("8d91")}});
//# sourceMappingURL=app.f663a2db.js.map